
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../requirements/">
      
      
        <link rel="next" href="../changelog/">
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.1.21">
    
    
      
        <title>FAQ - EPR Integration Kit for CARA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="matchbox" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#faq-integration-requests" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="EPR Integration Kit for CARA" class="md-header__button md-logo" aria-label="EPR Integration Kit for CARA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EPR Integration Kit for CARA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FAQ
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="EPR Integration Kit for CARA" class="md-nav__button md-logo" aria-label="EPR Integration Kit for CARA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    EPR Integration Kit for CARA
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Primary system integration with CARA
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../eprik-config/" class="md-nav__link">
        EPRIK Configuration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usecases/" class="md-nav__link">
        EPRIK Usecases
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../primarysystems-epr/" class="md-nav__link">
        EPR Primary System Integration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../transferts/" class="md-nav__link">
        Transferts Integration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../pmp/" class="md-nav__link">
        PMP Integration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../requirements/" class="md-nav__link">
        CARA Requirements
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          FAQ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        FAQ
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#faq-integration-requests" class="md-nav__link">
    FAQ Integration Requests
  </a>
  
    <nav class="md-nav" aria-label="FAQ Integration Requests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#http-error-code-202-for-soap-request-eg-iti-18" class="md-nav__link">
    HTTP Error code 202 for SOAP Request (e.g. ITI-18)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-type-returned-not-multipartrelated-but-applicationxml" class="md-nav__link">
    Content-Type returned not multipart/related but application/xml
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sts-error-500-with-tcu" class="md-nav__link">
    STS error 500 with TCU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iti-41-http-error-code-500-soapbody-no-line-breaks-in-requests" class="md-nav__link">
    ITI-41: HTTP Error code 500 (soap:body no line breaks in requests)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iti-45-no-mpi-pid-in-iti-45-response-if-queried-with-ahvn13" class="md-nav__link">
    ITI-45: No MPI-PID in ITI-45 response if queried with AHVN13
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iti-45iti-47-no-patient-data-returned" class="md-nav__link">
    ITI-45/ITI-47: No Patient data returned
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idp-hin-id" class="md-nav__link">
    IdP HIN ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idp-trust-id" class="md-nav__link">
    IdP TRUST ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-if-tcu-certificate-is-correctly-installed" class="md-nav__link">
    Verify if TCU certificate is correctly installed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        CARA INT Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../changelog_eprik/" class="md-nav__link">
        EPRIK Changelog
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#faq-integration-requests" class="md-nav__link">
    FAQ Integration Requests
  </a>
  
    <nav class="md-nav" aria-label="FAQ Integration Requests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#http-error-code-202-for-soap-request-eg-iti-18" class="md-nav__link">
    HTTP Error code 202 for SOAP Request (e.g. ITI-18)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#content-type-returned-not-multipartrelated-but-applicationxml" class="md-nav__link">
    Content-Type returned not multipart/related but application/xml
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sts-error-500-with-tcu" class="md-nav__link">
    STS error 500 with TCU
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iti-41-http-error-code-500-soapbody-no-line-breaks-in-requests" class="md-nav__link">
    ITI-41: HTTP Error code 500 (soap:body no line breaks in requests)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iti-45-no-mpi-pid-in-iti-45-response-if-queried-with-ahvn13" class="md-nav__link">
    ITI-45: No MPI-PID in ITI-45 response if queried with AHVN13
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iti-45iti-47-no-patient-data-returned" class="md-nav__link">
    ITI-45/ITI-47: No Patient data returned
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idp-hin-id" class="md-nav__link">
    IdP HIN ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idp-trust-id" class="md-nav__link">
    IdP TRUST ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-if-tcu-certificate-is-correctly-installed" class="md-nav__link">
    Verify if TCU certificate is correctly installed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>FAQ</h1>

<h2 id="faq-integration-requests">FAQ Integration Requests</h2>
<h3 id="http-error-code-202-for-soap-request-eg-iti-18">HTTP Error code 202 for SOAP Request (e.g. ITI-18)</h3>
<p>check that in the SOAP WS:Header the <code>&lt;Address&gt;</code> element is in the same nampespace as the <code>&lt;ReplyTo&gt;</code> Element:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">&lt;a:ReplyTo</span><span class="w"> </span><span class="na">s:mustUnderstand=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">xmlns:a=</span><span class="s">&quot;http://www.w3.org/2005/08/addressing&quot;</span><span class="nt">&gt;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="nt">&lt;a:Address&gt;</span>http://www.w3.org/2005/08/addressing/anonymous<span class="nt">&lt;/a:Address&gt;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nt">&lt;/a:ReplyTo&gt;</span>
</code></pre></div>
<h3 id="content-type-returned-not-multipartrelated-but-applicationxml">Content-Type returned not multipart/related but application/xml</h3>
<p>ITI-TF says that one should use <em>multipart/related</em>,
see <a href="https://profiles.ihe.net/ITI/TF/Volume2/ITI-43.html#3.43.5.1.1.1">ITI-43 §3.43.5.1.1.1</a>,
verify that you have <code>start-info="application/soap+xml; charset=utf-8"</code> (or no <code>start-info</code>).</p>
<p>e.g:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Content-Type: multipart/related; boundary=&quot;uuid:f42c35e4-54b2-45ca-8fda-ed58b11f6fce&quot;;type=&quot;application/xop+xml&quot;; start=&quot; &lt;root.message@cxf.apache.org&gt;&quot;;start-info=&quot;application/soap+xml; charset=utf-8&quot;
</code></pre></div>
<p>Please check also that the <code>&lt;xop:Include&gt;</code> has no whitespace/linebreaks before or after the
tag <a href="https://profiles.ihe.net/ITI/TF/Volume2/ch-V.html#Appendix%20V:~:text=Example%20of%20XOP-,optimized,-content.%C2%A0%20NOTE%3A%C2%A0%20xop">source</a>,
with linebreaks you get an HTTP 500 error (currently the EPR Integration kit shows it all the time wrapped, verify it
with download request).</p>
<h3 id="sts-error-500-with-tcu">STS error 500 with TCU</h3>
<p>if some STS TCU requests work and some not, check that you are in sync with the NTP time server, even below second
differences can provoke
that the assertion could be in the future for the STS (notBefore element,
see <a href="https://github.com/ahdis/ch-emed-pmp/issues/40">issue</a>)</p>
<p>check also that you have no xml comments in request</p>
<h3 id="iti-41-http-error-code-500-soapbody-no-line-breaks-in-requests">ITI-41: HTTP Error code 500 (soap:body no line breaks in requests)</h3>
<p>2024-04-25: if the soap body is formatted with line breaks in the request, the request will not go through the back
end (warning: empty request) and an http error 500 is returned, see xop:include comment above</p>
<h3 id="iti-45-no-mpi-pid-in-iti-45-response-if-queried-with-ahvn13">ITI-45: No MPI-PID in ITI-45 response if queried with AHVN13</h3>
<p>This is a data problem. Multiple local patients were either automatically or manually merged into the same master
patient.</p>
<h3 id="iti-45iti-47-no-patient-data-returned">ITI-45/ITI-47: No Patient data returned</h3>
<p>Verify that the receiver id in the hl7 v3 message contains the oid for the integration system (
2.16.756.5.30.1.191.1.0.12.1.101.2).
You can also try to change the receiver OID to a random OID; if the patient data is returned, then someone fed a bad
identifier to the patient and CARA needs to clean it manually.</p>
<h3 id="idp-hin-id">IdP HIN ID</h3>
<ol>
<li>you need to have a GLN assigned to the HIN user that, otherwise the STS [ITI-40] will not work since the NameID is
   not known</li>
<li>the test HIN ID expires after six months</li>
</ol>
<h3 id="idp-trust-id">IdP TRUST ID</h3>
<ol>
<li>if you authenticate with trust ID and eprik you have to provide the SAML2 NameID to be configured</li>
<li>you can get test trust id <a href="https://register-int.trustid.ch/trustid">here</a> and manage
   it <a href="https://my-int.trustid.ch">here</a></li>
</ol>
<h3 id="verify-if-tcu-certificate-is-correctly-installed">Verify if TCU certificate is correctly installed</h3>
<p>for the <a href="https://test.ahdis.ch/eprik-cara/#/transaction/1b60dd65-182a-4faf-8df7-edb70ef3184b">STS request</a> the public
certificate is added in the <code>&lt;ds:X509Certificate&gt;</code> in the <code>&lt;saml2:Assertion&gt;</code>. You can get the fingerprint of it copying
the content of the <code>&lt;ds:X509Certificate&gt;</code> into the echo '' part:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>echo &#39;MII... =&#39; | base64 -d | openssl x509 -noout -text -fingerprint -sha1
</code></pre></div>
<p>The resulting sha1 Fingerprint=73:85:78:C8:C8:0C:DE:5D:7A:3E:06:38:6B:80:6E:65:47:FB:61:18 can be checked in the cara
admin portal if the certificate is available there.
For the STS request it is important that the oid attributed to the user/certificate (showing in parentheses) in also
added in the STS request in the <code>&lt;saml2:NameID&gt;</code>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>